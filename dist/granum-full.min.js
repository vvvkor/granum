/*! granum-full.js v1.2.51 */
(()=>{var b=(e,a,n)=>{a=a&&a.constructor===Array?a:(a||"").split(/\s+/),e.forEach(t=>a.forEach(e=>e?t.classList[n?"add":"remove"](e):null))};document.addEventListener("DOMContentLoaded",e=>{document.dispatchEvent(new Event("granum-start")),document.querySelectorAll("a.toggle").forEach(e=>e.click()),document.querySelectorAll("input[data-nodes], select[data-nodes]").forEach(e=>"radio"!=e.type||e.checked?e.dispatchEvent(new Event("input",{bubbles:!0})):null),document.body.dataset.ready="",document.querySelectorAll('.tabs :first-child a[href^="#"]').forEach(e=>e.click()),document.querySelectorAll("table").forEach(e=>{(e.className.match(/\b[lcr]\d\d?\b/g)||[]).forEach(t=>{e.querySelectorAll("tr>*:nth-child("+t.slice(1)+")").forEach(e=>e.classList.add(t.slice(0,1)))})}),window.dispatchEvent(new Event("resize")),window.dispatchEvent(new Event("hashchange")),document.dispatchEvent(new Event("granum-ready"))}),document.addEventListener("submit",e=>{e.target.classList.contains("dialog")&&!confirm(e.target.title||"Continue?")&&e.preventDefault()}),document.addEventListener("click",e=>{const t=e.target,a=t.closest("a"),n=t.closest("button.dialog, input.dialog");if(n&&n.form&&n.form.checkValidity()&&!confirm(n.title||n.textContent)&&e.preventDefault(),a)if("#back"==a.hash)e.preventDefault(),history.go(-1);else if(a.classList.contains("dialog")){var l=a.dataset.prompt;l?(e.preventDefault(),null!=(c=prompt(a.title||a.textContent,a.dataset.default||""))&&(location.href=a.href.replace(l,c))):confirm(a.title||a.textContent)||e.preventDefault()}else if(a.classList.contains("toggle")){e.preventDefault();const p=a.closest(".tabs");p&&p.querySelectorAll('a[href^="#"].act').forEach(e=>e.click());var o=a.dataset;const v=document.querySelectorAll(o.nodes||a.hash);var s=(o.set||"show").split(/\s+/),l="ready"in document.body.dataset,c=!v[0].classList.contains(s[0])!=!l;b([a],o.act||"act",c),b([a],o.inact,!c),b(v,s,c),b(v,o.unset,!c),l&&location.hash&&"show"==s[0]&&!p&&(location.hash="#cancel")}else if("item"in a.dataset){const h=a.closest(a.dataset.item||"div, li, tr");if(h){e.preventDefault();const f=h.previousElementSibling,g=h.nextElementSibling,y=h.parentNode;"delete"in a.dataset?!(1<h.parentNode.children.length)&&"keep"in a.dataset||h.remove():"up"in a.dataset?f?f.before(h):y.append(h):"down"in a.dataset?g?g.after(h):y.prepend(h):h.after(h.cloneNode(!0))}}const r=t.closest(".sort th, th.sort");if(r&&!t.closest("a, input, [name]")){var d=r.cellIndex;const n=r.closest("thead").nextElementSibling;if(1<n.rows.length){var i=r.closest("table").dataset.sort||"bg";const E=[...n.rows].map(e=>[e,e.cells[d].textContent.replace(/\s+$/,"")]).map(e=>[e[0],e[1],parseFloat(e[1])]);var u=isNaN(E[0][2])?1:2,m=r.classList.contains(i)&&E[0][u]<E[E.length-1][u]?-1:1;E.sort((e,t)=>e[u]<t[u]?-m:e[u]>t[u]?m:0),E.forEach(e=>n.append(e[0])),[...r.parentNode.children].forEach(e=>e.classList[e==r?"add":"remove"](i))}}t.classList.contains("modal")&&(location.hash="#cancel")}),document.addEventListener("input",e=>{var t=e.target,e=t.dataset.check;e&&document.querySelectorAll(e).forEach(e=>e.checked=t.checked&&!e.closest("[hidden]")),"nodes"in t.dataset&&document.querySelectorAll(t.dataset.nodes).forEach(e=>e.className="checkbox"==t.type?t.dataset[t.checked?"set":"unset"]:t.value),t.dataset.filter&&document.querySelector(t.dataset.filter).querySelectorAll("tbody tr").forEach(e=>e.hidden=!(" "+e.textContent.replace(/\s+/g," ")+" ").match(new RegExp(t.value,"i")))}),document.addEventListener("keydown",e=>{"Escape"==e.key&&(location.hash="#cancel")}),window.addEventListener("resize",e=>{const t=document.body,a=(t.dataset.break||"900,500").split(",");a.push(0);var n=a.findIndex(e=>window.innerWidth>=Number(e));null!=t._m&&t._m==n||(t._m=n,document.querySelectorAll("[data-resp]").forEach(e=>{const t=e.dataset.resp.split(",");e.className=(null!=t[n]?t[n]:t.pop())||""}))}),window.addEventListener("hashchange",e=>{if(location.hash){let t=document.querySelector(".modal"+location.hash);t=t&&t.querySelector("a[href]:not(.empty), button, input, select, textarea"),t&&setTimeout(e=>{t.focus(),"text"==t.type&&t.select()},10)}})})(),(()=>{var n="form[data-restore] [name]:not([data-unstore])",l=e=>"store:"+(e.form.dataset.restore||"")+":"+e.name+("checkbox"==e.type?":"+e.value:"");document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll("form[data-get]").forEach(e=>{e.querySelectorAll("[name]").forEach(e=>"get"in e.dataset?null:e.dataset.get=e.name)}),document.querySelectorAll("[name][data-get]").forEach(e=>e.dispatchEvent(new Event("granum-get",{bubbles:!0})))}),document.addEventListener("reset",e=>{const t=e.target.querySelector('[type="reset"]');t&&t.classList.contains("dialog")&&!confirm(t.title||"Reset?")?e.preventDefault():e.target.querySelectorAll(n).forEach(e=>localStorage.removeItem(l(e)))}),document.addEventListener("input",e=>{const t=e.target;!t.matches(n)||t.type.match(/password|file|submit|image/)||"radio"==t.type&&!t.checked||localStorage.setItem(l(t),"checkbox"==t.type?t.checked?1:"":null!=t.dataset.cap?t.dataset.cap:t.value)}),document.addEventListener("granum-get",e=>{const t=e.target;e=t.dataset.get||t.name;const a=new URL(location).searchParams;a.has(e)?"checkbox"==t.type?t.checked=a.getAll(e).includes(t.value):"radio"==t.type?t.checked=a.get(e)===t.value:t.value=a.get(e):!t.matches(n)||null!=(e=localStorage.getItem(l(t)))&&("checkbox"==t.type?t.checked=e:"radio"==t.type?t.checked=e===t.value:t.value=e)})})(),(()=>{var a={Escape:7,Tab:9,ArrowLeft:-1,ArrowRight:1},l=e=>document.querySelectorAll("a.pic").forEach(e=>e.classList.remove("modal")),o=(t,e)=>{if(7==e)return l();if(9==e)return location.href=t.href;const a=[...(t.closest(".gallery")||document).querySelectorAll("a.pic")];var n=a.findIndex(e=>e==t);e&&!(t=a[n+e])||(l(),t.classList.add("modal"),t.style.background='#000 url("'+t.href+'") no-repeat 50% 50% / contain',e=n+(2*e||1),t.firstElementChild.style.background=a[e]?'#000 url("'+a[e].href+'") no-repeat 50% 50% / contain':"")};document.addEventListener("click",e=>{const t=e.target.closest("a.pic");t&&(e.preventDefault(),n=t.classList.contains("modal")?o(t,e.clientY<50&&t.clientWidth-e.clientX<50?7:e.clientX<t.clientWidth/2?-1:1):o(t))}),document.addEventListener("keydown",e=>{var t=document.querySelector("a.pic.modal");t&&e.key in a&&o(t,a[e.key])})})(),(()=>{let s=null;var o=(e,t)=>e.dispatchEvent(new Event(t,{bubbles:!0})),c=(e,t,a,n)=>{e.value=a,t.value=t.dataset.cap=n,o(e,"input"),o(t,"input")},n=e=>{clearTimeout(s),r(e).style.display="",e.value=e.dataset.cap};const r=e=>e.previousSibling.lastChild;var d=e=>e.previousSibling.previousSibling;document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll("[data-lookup]").forEach(e=>{e.hidden=!0;var t=e.dataset.caption||"";const a=document.createElement("input");a.type="text",a.className="lookup",a.name="lookup-"+e.name,a.value=a.defaultValue=t,a.autocomplete="off","get"in e.dataset&&(a.dataset.get=""),e.required&&(a.required=!0),e.after(a);const n=document.createElement("div");if(n.className="pop fit",n.innerHTML='<div class="look hide"></div>',e.after(n),e.dataset.goto){const l=document.createElement("span");l.innerHTML=' <a href="#goto" class="icon-right empty" data-goto><b>&rarr;</b></a>',a.after(l)}o(a,"granum-get"),a.dataset.cap=a.value})}),document.addEventListener("input",e=>{var n=e.target.closest(".lookup");if(n){clearTimeout(s);const l=r(n),o=d(n);l.style.display="",s=setTimeout(e=>{if(""===n.value)c(o,n,"","");else{const a=o.dataset.lookup.split("#");var t=n.value;fetch(a[0].replace(/\{q\}/,encodeURIComponent(n.value))).then(e=>e.ok?e.json():[]).then(e=>{n.value===t&&(l.innerHTML=e.slice(0,o.dataset.limit||5).map((e,t)=>'<div data-cmd class="pad hover'+(t?"":" bg")+'" data-id="'+e[a[1]||"id"]+'"><div>'+e[a[2]||"name"]+"</div>"+(e[a[3]||"info"]?'<div class="small text-n">'+e[a[3]||"info"]+"</div>":"")+"</div>").join(""),l.style.display="block")})}},300)}}),document.addEventListener("click",e=>{let t=e.target.closest(".look [data-id]");if(t){clearTimeout(s);const a=t.closest(".pop").nextSibling;c(d(a),a,t.dataset.id,t.firstChild.textContent),a.focus()}const a=e.target.closest(".lookup");document.querySelectorAll(".lookup").forEach(e=>e==a?null:n(e)),t=e.target.closest("a[data-goto]"),t=t&&d(t.parentNode.previousSibling),t&&(e.preventDefault(),t.value&&(location.href=t.dataset.goto.replace(/\{id\}/,encodeURIComponent(t.value))))}),document.addEventListener("keydown",e=>{var t=e.target.closest(".lookup:focus");if(t){const a=r(t);if("Escape"==e.key||"Tab"==e.key)n(t);else if("ArrowUp"==e.key||"ArrowDown"==e.key)if(a.style.display){let t=a.querySelector("div.bg");t=t?"ArrowUp"==e.key?t.previousSibling||a.lastChild:t.nextSibling||a.firstChild:a.firstChild,a.querySelectorAll("div").forEach(e=>e.classList[e==t?"add":"remove"]("bg"))}else o(t,"input");else"Enter"!=e.key||(t=a.querySelector("div.bg"))&&(a.style.display&&e.preventDefault(),o(t,"click"))}})})(),(()=>{var o=(e,t)=>e.dispatchEvent(new Event(t,{bubbles:!0})),a=e=>document.querySelectorAll(".month").forEach(e=>e.style.display=""),r=(e,t)=>new Date(e.valueOf()+864e5*t),d=(e,t)=>new Date(e-6e4*(new Date).getTimezoneOffset()).toISOString().slice(0,t||10).replace("T"," ").replace("."==document.body.dataset.dt?/(\d+)-(\d+)-(\d+)(.*)/:"!","$3.$2.$1$4"),i=(e,t,a)=>'<td class="c hover browse" data-cmd data-date="'+d(new Date(e.getFullYear(),e.getMonth()+t))+'">'+a;const s=(e,t,a)=>{let n=new Date(t.replace(/(\d+)\.(\d+)\.(\d+)(.*)/,"$3-$2-$1$4").replace(" ","T"));if(!n.getYear()){if(t)return;n=new Date}const l=new Date(n.getFullYear(),n.getMonth(),1,9);var o=r(l,9),s=(l.getDay()+6)%7,t=(t=l,new Date(t.getFullYear(),t.getMonth()+1,0).getDate()),c=a?a.slice(0,10):d(new Date);e.innerHTML='<table><tr class="text-n">'+i(o,-12,"&laquo;")+i(o,-1,"&lsaquo;")+"<td colspan=3 class=c>"+d(l,7)+i(o,1,"&rsaquo;")+i(o,12,"&raquo;")+"<tr>"+Array(s).fill().map(e=>"<td>").concat(Array(t).fill().map((e,t)=>{var a=(t+s)%7,n=d(r(l,t));return(a?"":"<tr>")+'<td class="c hover'+(c==n?" bg-w":"")+(4<a?" text-e":"")+'" data-cmd data-date="'+n+'">'+(t+1)})).join("")+"</table>",e.style.display="block"};document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll(".calendar").forEach(e=>{var t=e.step||e.dataset.step;e.dataset.len="text"==e.type&&!t||"date"==e.type?10:(t||60)<60?19:16,e.type="text";const a=document.createElement("div");a.className="pop fit",e.before(a),e.autocomplete="off",o(e,"granum-get"),e.value.match("-")&&(e.value=d(new Date(e.value),e.dataset.len)),e.defaultValue.match("-")&&(e.defaultValue=d(new Date(e.defaultValue),e.dataset.len)),a.innerHTML+='<div class="month pad rad hide"></div>';const n=document.createElement("span");n.innerHTML=' <a href="#now" data-date=NOW class="icon-ok empty"><b>&check;</b></a> <a href="#reset" data-date class="icon-delete empty"><b>&cross;</b></a>',e.after(n)})}),document.addEventListener("input",e=>e.target.matches(".calendar:focus")?o(e.target,"click"):null),document.addEventListener("click",e=>{e.target.closest(".month")||a();var t=e.target.closest(".calendar");t?s(t.previousSibling.lastChild,t.value,t.value):e.target.closest("[data-date]")&&(e=>{e.preventDefault();const t=e.target;let a=t.closest(".pop");a=a?a.nextSibling:t.parentNode.previousSibling;const n=a.previousSibling.lastChild;var l=t.dataset.date;if(t.classList.contains("browse"))return s(n,l,a.value);e=a.dataset.len,a.value="NOW"===l?d(Date.now(),e):l?l+a.value.substring(10,e):"",n.style.display="",o(a,"input"),a.focus()})(e)}),document.addEventListener("keydown",e=>{"Escape"!=e.key&&"Tab"!=e.key||a()})})(),(()=>{var t=(e,a)=>e.querySelectorAll("[contenteditable][data-for]").forEach(e=>{var t=document.getElementById(e.dataset.for);t&&(e.innerHTML=t[a?"defaultValue":"value"])});document.addEventListener("DOMContentLoaded",e=>t(document,!1)),document.addEventListener("reset",e=>e.defaultPrevented?null:t(e.target,!0)),document.addEventListener("click",e=>{const t=e.target.closest("a");if(t&&t.hash&&t.dataset.cmd){const a=document.getElementById(t.hash.slice(1));a&&(e.preventDefault(),null!=(e="ask"in t.dataset?prompt(t.title||t.dataset.cmd,t.dataset.ask):"arg"in t.dataset?t.dataset.arg:"")&&(a.focus(),document.execCommand(t.dataset.cmd,!1,e)))}}),document.addEventListener("input",e=>{if(e.target.dataset.for){const t=document.getElementById(e.target.dataset.for);t&&(t.value=e.target.innerHTML),t.dispatchEvent(new CustomEvent("input",{bubbles:!0,detail:1}))}if(e.target.id&&"TEXTAREA"==e.target.tagName&&!e.detail){const a=document.querySelector('[data-for="'+e.target.id+'"]');a&&(a.innerHTML=e.target.value)}})})();