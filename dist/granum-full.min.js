/*! granum-full.js v1.2.25 */
(()=>{var y=(e,a,n)=>{a=a&&a.constructor===Array?a:(a||"").split(/\s+/),e.forEach(t=>a.forEach(e=>e?t.classList[n?"add":"remove"](e):null))};document.addEventListener("DOMContentLoaded",e=>{console.log("granum.js started"),document.querySelectorAll("form[data-get]").forEach(e=>{e.querySelectorAll("[name]").forEach(e=>"get"in e.dataset?null:e.dataset.get=e.name)}),document.querySelectorAll("[name][data-get]").forEach(e=>{var t=e.dataset.get||e.name;const a=location.href.match(new RegExp("(\\?|&)_?"+t+"=(.*?)($|&|#)"));a&&(t=decodeURIComponent(a[2].replace(/\+/g," ")),"checkbox"==e.type?e.checked=t&&"0"!==t:"radio"==e.type?e.checked=t&&e.value===t:e.value=t)}),document.querySelectorAll("a.toggle").forEach(e=>e.click()),document.querySelectorAll("input[data-nodes], select[data-nodes]").forEach(e=>"radio"!=e.type||e.checked?e.dispatchEvent(new Event("input",{bubbles:!0})):null),document.body.dataset.ready="",document.querySelectorAll('.tabs :first-child a[href^="#"]').forEach(e=>e.click()),document.querySelectorAll("table").forEach(e=>{(e.className.match(/\b[lcr]\d\d?\b/g)||[]).forEach(t=>{e.querySelectorAll("tr>*:nth-child("+t.substr(1)+")").forEach(e=>e.classList.add(t.substr(0,1)))})}),window.dispatchEvent(new Event("resize")),document.dispatchEvent(new Event("granum"))}),document.addEventListener("click",e=>{const t=e.target,a=t.closest("a");if(a){if(a.classList.contains("dialog")&&((l=a.dataset.prompt)?(e.preventDefault(),null!=(s=prompt(a.title||a.textContent,a.dataset.default||""))&&(location.href=a.href.replace(l,s))):confirm(a.title||a.textContent)||e.preventDefault()),a.classList.contains("toggle")){e.preventDefault();const p=a.closest(".tabs");p&&p.querySelectorAll('a[href^="#"].act').forEach(e=>e.click());var n=a.dataset;const m=document.querySelectorAll(n.nodes||a.hash);var o=(n.set||"show").split(/\s+/),l="ready"in document.body.dataset,s=!m[0].classList.contains(o[0])!=!l;y([a],n.act||"act",s),y([a],n.inact,!s),y(m,o,s),y(m,n.unset,!s),l&&location.hash&&"show"==o[0]&&!p&&(location.hash="#cancel")}if("item"in a.dataset){const h=a.closest(a.dataset.item||"div, li, tr");h&&(e.preventDefault(),"delete"in a.dataset?!(1<h.parentNode.children.length)&&"keep"in a.dataset||h.parentNode.removeChild(h):"up"in a.dataset?h.parentNode.insertBefore(h,h.previousElementSibling):"down"in a.dataset?h.parentNode.insertBefore(h,h.nextElementSibling?h.nextElementSibling.nextElementSibling:h.parentNode.firstElementChild):h.parentNode.insertBefore(h.cloneNode(!0),h.nextElementSibling))}}const c=t.closest(".sort th, th.sort");if(c&&!t.closest("a, input, [name]")){var d=c.cellIndex;const v=c.closest("thead").nextElementSibling;if(1<v.rows.length){var r=c.closest("table").dataset.sort||"bg";const f=[...v.rows].map(e=>[e,e.cells[d].textContent.replace(/\s+$/,"")]).map(e=>[e[0],e[1],parseFloat(e[1])]);var i=isNaN(f[0][2])?1:2,u=c.classList.contains(r)&&f[0][i]<f[f.length-1][i]?-1:1;f.sort((e,t)=>e[i]<t[i]?-u:e[i]>t[i]?u:0),f.forEach(e=>v.appendChild(e[0])),[...c.parentNode.children].forEach(e=>e.classList[e==c?"add":"remove"](r))}}t.classList.contains("modal")&&(location.hash="#cancel")}),document.addEventListener("input",e=>{var t=e.target,e=t.dataset.check;e&&document.querySelectorAll(e).forEach(e=>e.checked=t.checked),"nodes"in t.dataset&&document.querySelectorAll(t.dataset.nodes).forEach(e=>e.className="checkbox"==t.type?t.dataset[t.checked?"set":"unset"]:t.value)}),document.addEventListener("keydown",e=>{"Escape"==e.key&&(location.hash="#cancel")}),window.addEventListener("resize",e=>{const t=document.body,a=(t.dataset.break||"900,500").split(",");a.push(0);var n=a.findIndex(e=>window.innerWidth>=Number(e));null!=t._m&&t._m==n||(t._m=n,document.querySelectorAll("[data-resp]").forEach(e=>{const t=e.dataset.resp.split(",");e.className=(null!=t[n]?t[n]:t.pop())||""}))})})()(e=>{var a={Escape:7,Tab:9,ArrowLeft:-1,ArrowRight:1},o=e=>document.querySelectorAll("a.pic").forEach(e=>e.classList.remove("modal")),l=(t,e)=>{if(7==e)return o();if(9==e)return location.href=t.href;const a=[...(t.closest(".gallery")||document).querySelectorAll("a.pic")];var n=a.findIndex(e=>e==t);e&&!(t=a[n+e])||(o(),t.classList.add("modal"),t.style.background='#000 url("'+t.href+'") no-repeat 50% 50% / contain',e=n+(2*e||1),t.firstElementChild.style.background=a[e]?'#000 url("'+a[e].href+'") no-repeat 50% 50% / contain':"")};document.addEventListener("click",e=>{const t=e.target.closest("a.pic");t&&(e.preventDefault(),n=t.classList.contains("modal")?l(t,e.clientY<50&&t.clientWidth-e.clientX<50?7:e.clientX<t.clientWidth/2?-1:1):l(t))},!1),document.addEventListener("keydown",e=>{var t=document.querySelector("a.pic.modal");t&&e.key in a&&l(t,a[e.key])})})()(e=>{let s=null;var o=(e,t)=>e.dispatchEvent(new Event(t,{bubbles:!0})),c=e=>document.querySelectorAll(".lookup + div").forEach(e=>e.style.display=""),d=(e,t,a,n)=>{e.value=a,t.value=t.dataset.cap=n,o(e,"input"),o(e,"change")};document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll("[data-lookup]").forEach(e=>{e.hidden=!0;const t=document.createElement("div");t.className="pop",t.innerHTML='<input class="lookup" value="'+e.dataset.caption+'" data-cap="'+e.dataset.caption+'"><div class="hide"></div>',e.parentNode.insertBefore(t,e.nextSibling),t.lastChild.style.cursor="pointer"})}),document.addEventListener("input",e=>{var n=e.target.closest(".lookup");if(n){clearTimeout(s);const o=n.nextSibling,l=o.parentNode.previousSibling;o.style.display="",s=setTimeout(e=>{if(c(),""===n.value)d(l,n,"","");else{const a=l.dataset.lookup.split("#");var t=n.value;fetch(a[0].replace(/\{q\}/,encodeURIComponent(n.value))).then(e=>e.ok?e.json():[]).then(e=>{n.value===t&&(o.innerHTML=e.slice(0,5).map((e,t)=>'<div class="pad hover'+(t?"":" bg")+'" data-lookid="'+e[a[1]||"id"]+'"><div>'+e[a[2]||"name"]+"</div>"+(e[a[3]||"info"]?'<div class="small text-n">'+e[a[3]||"info"]+"</div>":"")+"</div>").join(""),o.style.display="block")})}},300)}}),document.addEventListener("click",e=>{const t=e.target.closest("[data-lookid]");var a;t&&(clearTimeout(s),a=t.parentNode.previousSibling,d(a.parentNode.previousSibling,a,t.dataset.lookid,t.firstChild.textContent),t.parentNode.style.display=""),e.target.closest(".lookup, .lookup + div")||c()}),document.addEventListener("keydown",e=>{const t=e.target.closest(".lookup:focus");if(t){const n=t.nextSibling;if("Escape"==e.key)clearTimeout(s),n.style.display="",t.value=t.dataset.cap;else if("ArrowUp"==e.key||"ArrowDown"==e.key)if(n.style.display){let t=n.querySelector("div.bg");t=t?"ArrowUp"==e.key?t.previousSibling||n.lastChild:t.nextSibling||n.firstChild:n.firstChild,n.querySelectorAll("div").forEach(e=>e.classList[e==t?"add":"remove"]("bg"))}else o(t,"input");else{var a;"Enter"!=e.key||(a=n.querySelector("div.bg"))&&(n.style.display&&e.preventDefault(),o(a,"click"))}}})})(),document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll("[contenteditable][data-for]").forEach(e=>{var t=document.getElementById(e.dataset.for);t&&(e.innerHTML=t.value)})}),document.addEventListener("click",e=>{const t=e.target.closest("a");if(t&&t.hash&&t.dataset.cmd){const a=document.getElementById(t.hash.substr(1));a&&(e.preventDefault(),null!=(e="ask"in t.dataset?prompt(t.title||t.dataset.cmd,t.dataset.ask):"arg"in t.dataset?t.dataset.arg:"")&&(a.focus(),document.execCommand(t.dataset.cmd,!1,e)))}}),document.addEventListener("input",e=>{if(e.target.dataset.for){const t=document.getElementById(e.target.dataset.for);t&&(t.value=e.target.innerHTML)}if(e.target.id&&"TEXTAREA"==e.target.tagName){const a=document.querySelector('[data-for="'+e.target.id+'"]');a&&(a.innerHTML=e.target.value)}});